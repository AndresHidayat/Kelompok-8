<html>
    <head>
        <title>Tempat Peribadatan</title>
        <center><h1>SISTEM INFORMASI GEOGRAFIS</h1></center>
        <center><h2>Tempat Peribadatan</h2></center>
        <style>
            #map {
                background-color: black;
                width: 100%;
                height: 400px;
            }
        </style>
    </head>
    <body>
    
            <ul class="float">
                    <center><li><a href="#">Data Penduduk Per Kecamatan</a></li>
                    <li><a href="#">Agama Penduduk Perkecamatan</a></li>
                    <li><a href="#">Data Masjid</a></li>
                    <li><a href="#">Data Gereja </a></li>
                    <li><a href="#">Data Vihara</a></li>
                    <li><a href="#">Data Kelenteng</a></li>
                    <li><a href="#">Data Pura</a></li>
                   </ul></center>
                </body>
            <style>
                .float li
{
float: left;
list-style: none;
}
.menu{
    color:black;
text-decoration: none;
font-variant: small-caps;
background:rgb(46, 122, 2);
border: 1px solid  black;
padding: 10px 15px;
-webkit-transition:all 1s ease-out;
-moz-transition:all 1s ease-out;
-ms-transition:all 1s ease-out;
-o-transition:all 1s ease-out;
transition:all 1s ease-out;
}
.float li a 
{
color:black;
text-decoration: none;
font-variant: small-caps;
background:rgb(163, 161, 158);
border: 1px solid  black;
padding: 10px 15px;
-webkit-transition:all 1s ease-out;
-moz-transition:all 1s ease-out;
-ms-transition:all 1s ease-out;
-o-transition:all 1s ease-out;
transition:all 1s ease-out;
}



.float a:hover
{
text-decoration: black;
background:black;
color: #000;
}
    </style>
    <div id="map"></div>
    </body>
    <script>
        function initialize(){
	var mapOptions = {
		zoom:9,
		center: new google.maps.LatLng(-5.375130, 105.253640),
	};
	map = new google.maps.Map(document.getElementById('map'), mapOptions);
	
	infoWindow = new google.maps.InfoWindow();
	var infowindow = new google.maps.InfoWindow();
	
	var contentString;
	infowindow.setContent(contentString);
  
	var marker = new google.maps.Marker();
	marker.addListener('click',function(){
		infowindow.open(map,marker);
  ``});
	marker.setMap(map);
	
	var infoWin = new google.maps.InfoWindow();
    var labels = 'Bandar Lampung';
        
    var markers = locations.map(function(location, i) {
        var marker = new google.maps.Marker({
            position: location,
            label: labels[i % labels.length]
        });
		google.maps.event.addListener(marker, 'click', function(evt) {
			infoWin.setContent(location.info);
			infoWin.open(map, marker);
		})
		return marker;
    }); 
    
	console.log(locations);
    console.log(markers);

    var markerCluster = new MarkerClusterer(map, markers,
        {imagePath: 'images/m1'});
        
    var d = markerCluster.distanceBetweenPoints_(markers[2].getPosition(),markers[4].getPosition());
    console.log(markerCluster.getCalculator());

	var unila = new google.maps.Polygon({
		paths:[
			new google.maps.LatLng(-5.3590439, 105.2341747),
			new google.maps.LatLng(-5.381262, 105.2210641),
			new google.maps.LatLng(-5.3680861, 105.2332413),
			new google.maps.LatLng(-5.3674773, 105.2338153)
		], 
		strokeWeight: 3,
		fillColor: '#12A0C9',
		fillOpacity: 0.30,
		strokeColor: '#12A0C9',
		strokeOpacity: 0.7,
		name: '<center><h2>SPBU<h2><hr>'+
				'INFO:</center>'+
				'<center>Alamat :<br>'+
				'Fasilitas : <br>'+
				'Lain-lain : <br></center>', 
		map: map
	});
	google.maps.event.addListener(unila, 'click', showArrays);

    }
	
	function showArrays(event) {
		var vertices = this.getPath();
		var contentString = '<b>' + this.name + '</b>';
		infoWindow.setPosition(event.latLng);
		infoWindow.setContent(contentString);
		infoWindow.open(map);
	}
	google.maps.event.addDomListener(window, 'load', initialize);

        //data geolokasi dalam bentuk array objek
        var locations = [
        {coord:{lat: -5.4292573,lng: 105.2599042}, info:'<div class="info"><h1>Masjid Al-Furqon</h1><hr><p>Jl. Pangeran Diponegoro, Gulak Galik, Tlk. Betung Utara, Kota Bandar Lampung, Lampung 35212<p>....</div>'},
        {coord:{lat: -5.408606,lng:  105.2586579}, info:'<div class="info"><h1>Masjid Taqwa</h1><hr><p>Jl. Raden Intan No.61, Gn. Sari, Bandar Lampung, Kota Bandar Lampung, Lampung 35213<p>....</div>'},
        {coord:{lat: -5.4292573,lng:  105.1898664}, info:'<div class="info"><h1>Masjid Jami Al-Anwar</h1><hr><p>Jalan Laksamana Malahayati No. 100, Kangkung, Teluk Betung Selatan, Pesawahan, Tlk. Betung Sel., Kota Bandar Lampung, Lampung<p>.....</div>'},
        {coord:{lat: -5.3742442,lng:  105.245332 }, info:'<div class="info"><h1>Masjid Al-Hayah</h1><hr><p>l. Zainal Abidin Pagar Alam No.7, Gedong Meneng, Rajabasa, Kota Bandar Lampung, Lampung 35141<p>......</div>'},
        {coord:{lat: -5.3721075,lng:  105.248737}, info:'<div class="info"><h1>Masjid Baitul Ilmi</h1><hr><p>Jl. Zainal Abidin Pagar Alam, Gedong Meneng, Kedaton, Kota Bandar Lampung, Lampung 35132<p>.....</div>'},
        {coord:{lat: -5.3631805,lng:  105.2485138}, info:'<div class="info"><h1>Masjid Alhuda</h1><hr><p> JL. Sutan Jamil, No. 29, Gedong Meneng, Kedaton, Kota Bandar Lampung, Lampung 35147<p>......</div>'},
        {coord:{lat: -5.376733,lng:  105.2428007}, info:'<div class="info"><h1>Masjid Asy Syuhada</h1><hr><p>Kp. Baru, Kedaton, Kota Bandar Lampung, Lampung 35141<p>......</div>'},
        {coord:{lat: -5.3615539,lng:  105.2715251}, info:'<div class="info"><h1>Masjid Islamic Centre Baitul Mukhlisin</h1><hr><p>Jl. Lintas Liwa-Bandar Lampung, Dusun Sekuting, Pekon Watas, Rajabasa Raya, Lambung Barat<p>.....</div>'}
      ];
    //   google.maps.event.addDomListener(window, 'load', initMap);
    </script>
    <script src="https://www.gstatic.com/firebasejs/5.0.1/firebase.js"></script>
    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCojIfYtnnBBTZKlPe5Wvb-KnDPoV5kVWA&callback=initMap"></script>
    <script>
         var map = null;
        var center = { lat: -5.375130, lng: 105.253640};
        var infowindow;

          var config = {
         apiKey: "AIzaSyAsFosoH9osjLBkTWVqy6bVI8CiKXfClrs",
         authDomain: "my-project-1521552870465.firebaseapp.com",
         databaseURL: "https://my-project-1521552870465.firebaseio.com",
         projectId: "my-project-1521552870465",
        storageBucket: "my-project-1521552870465.appspot.com",
        messagingSenderId: "661888464762"
        };
        firebase.initializeApp(config);

        var db = firebase.database();
        var dataRef = db.ref('bandar_lampung')

        dataRef.on('value', showData, showError);
        function showData(data){
            //console.log(data.val());
            map.data.addGeoJson(data.val()); 
            map.data.setStyle({
                fillColor :'#4286f4',
                strokeWeight: 0.2
            });
            map.data.addListener('click', function(event){
                infoWindowContent = event.feature.getProperty('DESA')+"<br>"+event.feature.getProperty('KECAMATAN');
                infowindow.setContent(infoWindowContent);
                infowindow.setPosition(event.latLng);
                infowindow.open(map);
        
            });
        }
        function showError(err){
            console.log(err);
        }
        function initMap(){
            map = new google.maps.Map(document.getElementById('map'),{
                zoom: 11,
                center: center
            });
            infowindow = new google.maps.InfoWindow();
        }
    </script>
</html>